<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·è—¥å±€ - ç·šä¸Šé è¨‚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Microsoft JhengHei', sans-serif; background-color: #f3f4f6; }
    </style>
</head>
<body class="p-6">

    <header class="max-w-4xl mx-auto mb-8 text-center">
        <h1 class="text-3xl font-bold text-blue-600 mb-2">ğŸ¥ å¥åº·è—¥å±€ç·šä¸Šé è¨‚</h1>
        <p class="text-gray-600">è«‹é¸æ“‡éœ€è¦çš„å•†å“ï¼Œä¸¦å¡«å¯«é è¨‚è³‡è¨Š</p>
    </header>

    <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6">
        
        <div class="md:col-span-2 space-y-4" id="product-list">
            </div>

        <div class="bg-white p-6 rounded-lg shadow-lg h-fit sticky top-6">
            <h2 class="text-xl font-bold mb-4 border-b pb-2">ğŸ›’ æ‚¨çš„è³¼ç‰©è»Š</h2>
            <div id="cart-items" class="space-y-2 mb-4 text-sm text-gray-700">
                <p class="text-gray-400">ç›®å‰è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>
            </div>
            
            <div class="flex justify-between font-bold text-lg mb-6">
                <span>ç¸½é‡‘é¡ï¼š</span>
                <span id="total-price" class="text-blue-600">$0</span>
            </div>

            <form id="order-form" class="space-y-3">
                <input type="text" placeholder="æ‚¨çš„å§“å" required class="w-full p-2 border rounded">
                <input type="tel" placeholder="æ‰‹æ©Ÿè™Ÿç¢¼" required class="w-full p-2 border rounded">
                <textarea placeholder="å‚™è¨» (ä¾‹å¦‚: å–è²¨æ™‚é–“)" class="w-full p-2 border rounded"></textarea>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition">
                    é€å‡ºé è¨‚å–®
                </button>
            </form>
        </div>
    </div>

    <script>
        // 1. è¨­å®šå•†å“è³‡æ–™ 
        // (å¦‚æœæ‚¨æœ‰æ”¹éå•†å“åç¨±æˆ–åœ–ç‰‡ï¼Œè«‹åœ¨é€™è£¡æ‰‹å‹•æ›´æ–°å›ä¾†)
        const products = [
            { id: 1, name: "ç¶œåˆç¶­ä»–å‘½ Bç¾¤", price: 600, tag: "ä¿å¥", image: "images/1.jpg" },
            { id: 2, name: "é†«ç™‚ç”¨å£ç½© (50å…¥)", price: 250, tag: "é˜²ç–«", image: "images/å£ç½©.jpg" },
            { id: 3, name: "è‘‰é»ƒç´ è† å›Š", price: 1200, tag: "ä¿å¥", image: "images/è‘‰é»ƒç´ .jpg" },
            { id: 4, name: "é…’ç²¾å™´éœ§ 500ml", price: 150, tag: "é˜²ç–«", image: "images/é…’ç²¾.jpg" },
            { id: 5, name: "ç— ç—›è²¼å¸ƒ (10ç‰‡)", price: 300, tag: "å¤–ç”¨", image: "images/è²¼å¸ƒ.jpg" },
        ];

        // è³¼ç‰©è»Šç¾åœ¨æœƒå­˜ç‰©ä»¶ï¼š { product: å•†å“è³‡æ–™, qty: æ•¸é‡ }
        let cart = [];

        // 2. æ¸²æŸ“å•†å“åˆ—è¡¨ (æ–°å¢ï¼šæ•¸é‡é¸æ“‡æ¡†)
        const productListEl = document.getElementById('product-list');
        productListEl.innerHTML = ''; 

        products.forEach(product => {
            const itemHTML = `
                <div class="bg-white p-4 rounded-lg shadow flex items-center">
                    <div class="flex-shrink-0 mr-4">
                        <img src="${product.image}" alt="${product.name}" class="w-24 h-24 object-cover rounded-md border border-gray-200">
                    </div>
                    
                    <div class="flex-grow">
                        <span class="text-xs font-bold text-white bg-blue-400 px-2 py-1 rounded-full mb-1 inline-block">${product.tag}</span>
                        <h3 class="font-bold text-lg text-gray-800">${product.name}</h3>
                        <p class="text-blue-600 font-bold">$${product.price}</p>
                    </div>

                    <div class="flex-shrink-0 ml-2 flex flex-col items-end gap-2">
                        <div class="flex items-center text-sm text-gray-600">
                            æ•¸é‡: <input type="number" id="qty-input-${product.id}" value="1" min="1" class="w-12 border rounded text-center ml-1 p-1">
                        </div>
                        
                        <button onclick="addToCart(${product.id})" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-bold shadow-md transition transform active:scale-95">
                            + åŠ å…¥
                        </button>
                    </div>
                </div>
            `;
            productListEl.innerHTML += itemHTML;
        });

        // 3. åŠ å…¥è³¼ç‰©è»ŠåŠŸèƒ½ (å‡ç´šç‰ˆï¼šè®€å–æ•¸é‡)
        function addToCart(id) {
            // æŠ“å–è©²å•†å“çš„æ•¸é‡è¼¸å…¥æ¡†çš„å€¼
            const qtyInput = document.getElementById(`qty-input-${id}`);
            const qty = parseInt(qtyInput.value); // è½‰æˆæ•¸å­—
            
            if (qty <= 0) {
                alert("æ•¸é‡è‡³å°‘è¦ç‚º 1 å–”ï¼");
                return;
            }

            const product = products.find(p => p.id === id);
            
            // æª¢æŸ¥è³¼ç‰©è»Šå…§æ˜¯å¦å·²ç¶“æœ‰é€™å€‹å•†å“
            const existingItem = cart.find(item => item.product.id === id);

            if (existingItem) {
                // å¦‚æœå·²ç¶“æœ‰äº†ï¼Œå°±å¢åŠ æ•¸é‡
                existingItem.qty += qty;
            } else {
                // å¦‚æœæ²’æœ‰ï¼Œå°±æ–°å¢é€²å»
                cart.push({ product: product, qty: qty });
            }

            updateCart();
            // é‡ç½®è¼¸å…¥æ¡†ç‚º 1ï¼Œæ–¹ä¾¿ä¸‹æ¬¡é¸è³¼
            qtyInput.value = 1;
        }

        // 4. è³¼ç‰©è»Šå…§ä¿®æ”¹æ•¸é‡ (+/- æŒ‰éˆ•é‚è¼¯)
        function changeQty(index, change) {
            cart[index].qty += change;

            // å¦‚æœæ•¸é‡è®Šæˆ 0 æˆ–æ›´å°‘ï¼Œå°±ç§»é™¤è©²å•†å“
            if (cart[index].qty <= 0) {
                const confirmDelete = confirm(`ç¢ºå®šè¦ç§»é™¤ ${cart[index].product.name} å—ï¼Ÿ`);
                if(confirmDelete) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1; // å¦‚æœæŒ‰å–æ¶ˆï¼Œæ•¸é‡è¨­å› 1
                }
            }
            updateCart();
        }

        // 5. æ›´æ–°è³¼ç‰©è»Šé¡¯ç¤º (å‡ç´šç‰ˆï¼šé¡¯ç¤ºæ•¸é‡æŒ‰éˆ•)
        function updateCart() {
            const cartEl = document.getElementById('cart-items');
            const totalEl = document.getElementById('total-price');
            
            if (cart.length === 0) {
                cartEl.innerHTML = '<p class="text-gray-400">ç›®å‰è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>';
                totalEl.innerText = '$0';
                return;
            }

            cartEl.innerHTML = cart.map((item, index) => `
                <div class="flex justify-between items-center border-b pb-2 pt-2">
                    <div class="flex-grow">
                        <div class="text-gray-800 font-medium">${item.product.name}</div>
                        <div class="text-xs text-gray-500">å–®åƒ¹ $${item.product.price}</div>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <button onclick="changeQty(${index}, -1)" class="bg-gray-200 w-6 h-6 rounded text-gray-600 hover:bg-gray-300 font-bold flex items-center justify-center">-</button>
                        
                        <span class="w-6 text-center font-bold text-sm">${item.qty}</span>
                        
                        <button onclick="changeQty(${index}, 1)" class="bg-gray-200 w-6 h-6 rounded text-gray-600 hover:bg-gray-300 font-bold flex items-center justify-center">+</button>
                    </div>

                    <div class="ml-4 font-bold text-blue-600 w-16 text-right">
                        $${item.product.price * item.qty}
                    </div>
                </div>
            `).join('');

            // è¨ˆç®—ç¸½é‡‘é¡ (å–®åƒ¹ * æ•¸é‡)
            const total = cart.reduce((sum, item) => sum + (item.product.price * item.qty), 0);
            totalEl.innerText = '$' + total;
        }

        // 6. é€å‡ºè¡¨å–® (LINE æ ¼å¼ä¹Ÿé…åˆæ•¸é‡ä¿®æ”¹)
        document.getElementById('order-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if(cart.length === 0) {
                alert("è³¼ç‰©è»Šæ˜¯ç©ºçš„å–”ï¼");
                return;
            }

            const name = this.querySelector('input[type="text"]').value;
            const phone = this.querySelector('input[type="tel"]').value;
            const note = this.querySelector('textarea').value;
            const total = cart.reduce((sum, item) => sum + (item.product.price * item.qty), 0);

            let message = `ã€æ–°è¨‚å–®é€šçŸ¥ã€‘\n`;
            message += `----------------\n`;
            message += `å§“åï¼š${name}\n`;
            message += `é›»è©±ï¼š${phone}\n`;
            message += `----------------\n`;
            message += `è¨‚è³¼å•†å“ï¼š\n`;
            
            cart.forEach(item => {
                // è¨Šæ¯æ ¼å¼ï¼š å•†å“åç¨± x 3 ($ç¸½åƒ¹)
                message += `â— ${item.product.name} x ${item.qty} ($${item.product.price * item.qty})\n`;
            });

            message += `----------------\n`;
            message += `ç¸½é‡‘é¡ï¼š$${total}\n`;
            if(note) {
                message += `å‚™è¨»ï¼š${note}`;
            }

            // â˜…â˜…â˜… è«‹è¨˜å¾—ä¿®æ”¹é€™è£¡çš„ ID â˜…â˜…â˜…
            const lineID = "@000obksn"; 
            const lineUrl = "https://line.me/R/oaMessage/" + lineID + "/?" + encodeURIComponent(message);

            window.location.href = lineUrl;
        });
    </script>
</body>

</html>

