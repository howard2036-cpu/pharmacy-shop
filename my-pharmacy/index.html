<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·è—¥å±€ - ç·šä¸Šé è¨‚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Microsoft JhengHei', sans-serif; background-color: #f3f4f6; }
    </style>
</head>
<body class="p-6">

    <header class="max-w-4xl mx-auto mb-8 text-center">
        <h1 class="text-3xl font-bold text-blue-600 mb-2">ğŸ¥ å¥åº·è—¥å±€ç·šä¸Šé è¨‚</h1>
        <p class="text-gray-600">è«‹é¸æ“‡éœ€è¦çš„å•†å“ï¼Œä¸¦å¡«å¯«é è¨‚è³‡è¨Š</p>
    </header>

    <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6">
        
        <div class="md:col-span-2 space-y-4">
            
            <div id="filter-buttons" class="flex flex-wrap gap-2 mb-4">
                </div>

            <div id="product-list" class="space-y-4">
                </div>
        </div>
            </div>

        <div class="bg-white p-6 rounded-lg shadow-lg h-fit sticky top-6">
            <h2 class="text-xl font-bold mb-4 border-b pb-2">ğŸ›’ æ‚¨çš„è³¼ç‰©è»Š</h2>
            <div id="cart-items" class="space-y-2 mb-4 text-sm text-gray-700">
                <p class="text-gray-400">ç›®å‰è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>
            </div>
            
            <div class="flex justify-between font-bold text-lg mb-6">
                <span>ç¸½é‡‘é¡ï¼š</span>
                <span id="total-price" class="text-blue-600">$0</span>
            </div>

            <form id="order-form" class="space-y-3">
                <input type="text" placeholder="æ‚¨çš„å§“å" required class="w-full p-2 border rounded">
                <input type="tel" placeholder="æ‰‹æ©Ÿè™Ÿç¢¼" required class="w-full p-2 border rounded">
                <textarea placeholder="å‚™è¨» (ä¾‹å¦‚: å–è²¨æ™‚é–“)" class="w-full p-2 border rounded"></textarea>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition">
                    é€å‡ºé è¨‚å–®
                </button>
            </form>
        </div>
    </div>

    <script>
        // 1. è¨­å®šå•†å“è³‡æ–™ (æ–°å¢ desc æè¿°æ¬„ä½)
        const products = [
            { 
                id: 1, 
                name: "ç¶œåˆç¶­ä»–å‘½ Bç¾¤", 
                price: 600, 
                tag: "ä¿å¥", 
                image: "images/1.jpg",
                desc: "å«é«˜å–®ä½ B1ã€B6ã€B12ï¼Œå¢å¼·é«”åŠ›ï¼Œä¸Šç­æ—å¿…å‚™ã€‚" // â˜… æ–°å¢æè¿°
            },
            { 
                id: 2, 
                name: "é†«ç™‚ç”¨å£ç½© (50å…¥)", 
                price: 250, 
                tag: "é˜²ç–«", 
                image: "images/å£ç½©.jpg",
                desc: "ä¸‰å±¤é˜²è­·çµæ§‹ï¼Œå°ç£è£½é€ ï¼Œé€æ°£èˆ’é©ä¸æ‚¶ç†±ã€‚"
            },
            { 
                id: 3, 
                name: "è‘‰é»ƒç´ è† å›Š", 
                price: 1200, 
                tag: "ä¿å¥", 
                image: "images/è‘‰é»ƒç´ .jpg",
                desc: "æ¸¸é›¢å‹è‘‰é»ƒç´ å¥½å¸æ”¶ï¼Œä¿è­·æ™¶äº®ï¼Œé©åˆé•·æ™‚é–“ç”¨çœ¼è€…ã€‚"
            },
            { 
                id: 4, 
                name: "é…’ç²¾å™´éœ§ 500ml", 
                price: 150, 
                tag: "é˜²ç–«", 
                image: "images/é…’ç²¾.jpg",
                desc: "75% é†«ç™‚ç´šé…’ç²¾ï¼Œå±…å®¶ç’°å¢ƒæ¶ˆæ¯’ã€æ‰‹éƒ¨æ¸…æ½”çš†é©ç”¨ã€‚"
            },
            { 
                id: 5, 
                name: "ç— ç—›è²¼å¸ƒ (10ç‰‡)", 
                price: 300, 
                tag: "å¤–ç”¨", 
                image: "images/è²¼å¸ƒ.jpg",
                desc: "æ·»åŠ è–„è·ç²¾æ²¹ï¼Œæ¸…æ¶¼èˆ’ç·©ï¼Œé©ç”¨è‚©é ¸è…°èƒŒç— ç—›ã€‚"
            },
        ];

        let cart = [];
        let currentFilter = 'å…¨éƒ¨'; // ç›®å‰é¸ä¸­çš„åˆ†é¡

        // 2. åˆå§‹åŒ–ï¼šç”¢ç”ŸæŒ‰éˆ•ä¸¦é¡¯ç¤ºå•†å“
        document.addEventListener('DOMContentLoaded', () => {
            renderFilterButtons();
            renderProducts(products); // ä¸€é–‹å§‹é¡¯ç¤ºå…¨éƒ¨
        });

        // 3. æ¸²æŸ“åˆ†é¡æŒ‰éˆ•
        function renderFilterButtons() {
            const btnContainer = document.getElementById('filter-buttons');
            
            // æŠ“å‡ºæ‰€æœ‰çš„æ¨™ç±¤ï¼Œä¸¦åŠ ä¸Š 'å…¨éƒ¨'
            const tags = ['å…¨éƒ¨', ...new Set(products.map(p => p.tag))];

            btnContainer.innerHTML = tags.map(tag => `
                <button onclick="filterProducts('${tag}')" 
                    class="px-4 py-1 rounded-full text-sm font-bold border transition
                    ${tag === currentFilter 
                        ? 'bg-blue-600 text-white border-blue-600 shadow-md' 
                        : 'bg-white text-gray-600 border-gray-300 hover:bg-gray-100'}">
                    ${tag}
                </button>
            `).join('');
        }

        // 4. ç¯©é¸å•†å“é‚è¼¯
        function filterProducts(category) {
            currentFilter = category;
            renderFilterButtons(); // é‡æ–°æ¸²æŸ“æŒ‰éˆ•(ç‚ºäº†æ›´æ–°é¡è‰²ç‹€æ…‹)

            if (category === 'å…¨éƒ¨') {
                renderProducts(products);
            } else {
                const filtered = products.filter(p => p.tag === category);
                renderProducts(filtered);
            }
        }

        // 5. æ¸²æŸ“å•†å“åˆ—è¡¨ (æ–°å¢ï¼šé¡¯ç¤ºæè¿°æ–‡å­—)
        function renderProducts(list) {
            const productListEl = document.getElementById('product-list');
            
            if(list.length === 0) {
                productListEl.innerHTML = '<div class="text-gray-500 text-center py-8">æ²’æœ‰æ‰¾åˆ°ç›¸é—œå•†å“</div>';
                return;
            }

            productListEl.innerHTML = list.map(product => `
                <div class="bg-white p-4 rounded-lg shadow flex items-start">
                    <div class="flex-shrink-0 mr-4">
                        <img src="${product.image}" alt="${product.name}" class="w-24 h-24 object-cover rounded-md border border-gray-200">
                    </div>
                    
                    <div class="flex-grow min-w-0"> <div class="flex justify-between items-start">
                            <div>
                                <span class="text-xs font-bold text-blue-600 border border-blue-200 bg-blue-50 px-2 py-0.5 rounded-full mb-1 inline-block">${product.tag}</span>
                                <h3 class="font-bold text-lg text-gray-800 leading-tight">${product.name}</h3>
                            </div>
                            <p class="text-blue-600 font-bold ml-2 shrink-0">$${product.price}</p>
                        </div>
                        
                        <p class="text-sm text-gray-500 mt-1 mb-2 leading-snug">${product.desc}</p>
                    </div>

                    <div class="flex-shrink-0 ml-3 flex flex-col items-end gap-2">
                        <div class="flex items-center text-sm text-gray-600 bg-gray-100 rounded px-1">
                            <span class="text-xs mr-1">æ•¸</span>
                            <input type="number" id="qty-input-${product.id}" value="1" min="1" class="w-8 bg-transparent text-center outline-none font-bold">
                        </div>
                        
                        <button onclick="addToCart(${product.id})" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-bold shadow-md transition whitespace-nowrap">
                            + åŠ å…¥
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // 6. åŠ å…¥è³¼ç‰©è»Š (è·Ÿä¹‹å‰ä¸€æ¨£)
        function addToCart(id) {
            const qtyInput = document.getElementById(`qty-input-${id}`);
            const qty = parseInt(qtyInput.value);
            
            if (qty <= 0) {
                alert("æ•¸é‡è‡³å°‘è¦ç‚º 1 å–”ï¼");
                return;
            }

            const product = products.find(p => p.id === id);
            const existingItem = cart.find(item => item.product.id === id);

            if (existingItem) {
                existingItem.qty += qty;
            } else {
                cart.push({ product: product, qty: qty });
            }

            updateCart();
            qtyInput.value = 1; 
            
            // ç‚ºäº†è®“ä½¿ç”¨è€…æœ‰æ„Ÿè¦ºï¼Œå¯ä»¥åŠ ä¸€å€‹ç°¡å–®çš„æç¤º
            // alert(`å·²å°‡ ${qty} å€‹ ${product.name} åŠ å…¥è³¼ç‰©è»Š`); 
        }

        // 7. è³¼ç‰©è»Šå…§ä¿®æ”¹æ•¸é‡ (è·Ÿä¹‹å‰ä¸€æ¨£)
        function changeQty(index, change) {
            cart[index].qty += change;
            if (cart[index].qty <= 0) {
                const confirmDelete = confirm(`ç¢ºå®šè¦ç§»é™¤ ${cart[index].product.name} å—ï¼Ÿ`);
                if(confirmDelete) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1;
                }
            }
            updateCart();
        }

        // 8. æ›´æ–°è³¼ç‰©è»Š (è·Ÿä¹‹å‰ä¸€æ¨£)
        function updateCart() {
            const cartEl = document.getElementById('cart-items');
            const totalEl = document.getElementById('total-price');
            
            if (cart.length === 0) {
                cartEl.innerHTML = '<p class="text-gray-400">ç›®å‰è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>';
                totalEl.innerText = '$0';
                return;
            }

            cartEl.innerHTML = cart.map((item, index) => `
                <div class="flex justify-between items-center border-b pb-2 pt-2">
                    <div class="flex-grow">
                        <div class="text-gray-800 font-medium">${item.product.name}</div>
                        <div class="text-xs text-gray-500">å–®åƒ¹ $${item.product.price}</div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="changeQty(${index}, -1)" class="bg-gray-200 w-6 h-6 rounded text-gray-600 hover:bg-gray-300 font-bold flex items-center justify-center">-</button>
                        <span class="w-6 text-center font-bold text-sm">${item.qty}</span>
                        <button onclick="changeQty(${index}, 1)" class="bg-gray-200 w-6 h-6 rounded text-gray-600 hover:bg-gray-300 font-bold flex items-center justify-center">+</button>
                    </div>
                    <div class="ml-4 font-bold text-blue-600 w-16 text-right">
                        $${item.product.price * item.qty}
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((sum, item) => sum + (item.product.price * item.qty), 0);
            totalEl.innerText = '$' + total;
        }

        // 9. é€å‡ºè¡¨å–® (LINE ID è¨˜å¾—æ”¹)
        document.getElementById('order-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if(cart.length === 0) {
                alert("è³¼ç‰©è»Šæ˜¯ç©ºçš„å–”ï¼");
                return;
            }

            const name = this.querySelector('input[type="text"]').value;
            const phone = this.querySelector('input[type="tel"]').value;
            const note = this.querySelector('textarea').value;
            const total = cart.reduce((sum, item) => sum + (item.product.price * item.qty), 0);

            let message = `ã€æ–°è¨‚å–®é€šçŸ¥ã€‘\n`;
            message += `----------------\n`;
            message += `å§“åï¼š${name}\n`;
            message += `é›»è©±ï¼š${phone}\n`;
            message += `----------------\n`;
            message += `è¨‚è³¼å•†å“ï¼š\n`;
            
            cart.forEach(item => {
                message += `â— ${item.product.name} x ${item.qty} ($${item.product.price * item.qty})\n`;
            });

            message += `----------------\n`;
            message += `ç¸½é‡‘é¡ï¼š$${total}\n`;
            if(note) {
                message += `å‚™è¨»ï¼š${note}`;
            }

            // â˜…â˜…â˜… è«‹æ”¹é€™è£¡ â˜…â˜…â˜…
            const lineID = "@000obksn"; 
            const lineUrl = "https://line.me/R/oaMessage/" + lineID + "/?" + encodeURIComponent(message);

            window.location.href = lineUrl;
        });
    </script>
</body>

</html>


